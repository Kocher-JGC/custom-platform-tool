---
title: 页面数据结构和 API
slug: /access_page_data
---

| 术语 | 解释 |
|---|---|
| 页面数据结构 | 页面设计器设计页面最终产出的数据结构，用于存储组件、变量、业务关系描述等，以 json 的形式存储 |
| 平台 API | 提供修改平台数据能力的接口 |

### 1.1. 页面设计器的页面数据结构

概览：

```ts
const pageContent = {
  // 存储页面内容
  content: [],
  // 该页面的 id
  id: string,
  // 页面元数据描述，用于存储业务逻辑引用关系的数据节点
  meta: {},
  // 页面的名称
  title: string,
  // 页面 id，暂时无用
  pageID: string
}
```

#### 1.1.1. content

页面内容，用于描述页面如何布局，每个 widget 节点

#### 1.1.2. meta

TODO

```tsx
meta = {
  varRely: {

  },
  dataSource: {

  },
  actions: {

  },
}
```

### 1.2. 平台提供的 SDK

`@platform-widget-access/spec` 提供核心的接入规范，提供以下几种能力：

1. 组件接入：
   1. `PlatformWidget(meta)`
2. 属性项接入
   1. `PropItem(meta)`
3. 创建组件与属性项的依赖关系
   1. `CreateWidgetPropItemRely()`

```ts
import {
  CreateWidgetPropItemRely,
  PlatformWidget,
  PropItem,
} from "@platform-widget-access/spec";
// 具体用法参考 5～8 述章节
```

在属性项的 `render` 函数中，平台传入了 `PropItemRenderContext` ，提供属性项修改页面数据的能力：

```tsx
@PropItem({
  ...
})
export class TitleHelperSpec {
  render(ctx: PropItemRenderContext) {
    const { takeMeta, changeWidgetType } = ctx.platformCtx.meta;
    return (
      ...
    )
  }
}
```

[详情参考定义](https://10.0.4.55/custom-platform-v3-frontend-group/custom-platform-v3-frontend/tree/dev/packages/provider-app-pages-hub/PageDesigner/platform-access/platform-ctx-types.ts)

---
