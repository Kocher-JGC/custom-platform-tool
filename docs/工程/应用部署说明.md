# 应用部署说明

## 1. 安装说明

---

### 1.1. 先决条件

- 向运维申请带 docker 环境的服务器

---

### 1.2. 服务器

- 版本：centos 7

---

### 1.3. 部署

#### 1.3.1. 部署应用平台前端

进入虚拟机后，使用 root 用户操作，并开始创建必要的环境配置文件：

```shell
sudo su -
mkdir -p /var/custom-platform-app/config
cd /var/custom-platform-app/config
```

创建应用端的配置：

```shell
vi consumer-app-config.json
```

输入并编辑以下内容：

```json
{
  "pageServerUrlForApp": "http://192.168.14.181:5020", // 向 saas 服务发送请求的地址
  "saasServerUrl": "http://192.168.14.181:7090" // 页面服务器的地址
}
```

通过 docker 启动配置端：

```shell
# 1. 停止已部署的应用
docker stop consumer_app

# 2. 删除该应用容器
docker rm consumer_app

# 3. 拉去最新的应用
docker pull reg.hydevops.com/custom-platform-v3-frontend/consumer_app:release-main-flow

# 4. 通过 docker 启动应用
docker run -d --name consumer_app -p 5020:3000 -v /var/custom-platform-app/config/consumer-app-config.json:/usr/share/consumer-app/web-client/config.json reg.hydevops.com/custom-platform-v3-frontend/consumer_app:release-main-flow
```
